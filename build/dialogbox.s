;
; File generated by cc65 v 2.18 - N/A
;
	.fopt		compiler,"cc65 v 2.18 - N/A"
	.setcpu		"6502"
	.smart		on
	.autoimport	on
	.case		on
	.debuginfo	off
	.importzp	sp, sreg, regsave, regbank
	.importzp	tmp1, tmp2, tmp3, tmp4, ptr1, ptr2, ptr3, ptr4
	.macpack	longbranch
	.export		_active_dboxdata
	.export		_trigger_dialog_box
	.export		_draw_dialog_text
	.import		_set_data_pointer
	.export		_didDraw
	.export		_lineIndex
	.export		_charIndex
	.importzp	_temp0
	.importzp	_scroll_y
	.importzp	_nt
	.importzp	_game_mode
	.export		_dbox_tiles
	.export		_draw_box

.segment	"RODATA"

_dbox_tiles:
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$2C
	.byte	$31
	.byte	$31
	.byte	$31
	.byte	$31
	.byte	$31
	.byte	$31
	.byte	$31
	.byte	$31
	.byte	$31
	.byte	$31
	.byte	$31
	.byte	$31
	.byte	$31
	.byte	$31
	.byte	$31
	.byte	$31

.segment	"BSS"

_active_dboxdata:
	.res	2,$00
_didDraw:
	.res	1,$00
_lineIndex:
	.res	1,$00
_charIndex:
	.res	1,$00

; ---------------------------------------------------------------
; void __near__ trigger_dialog_box (__near__ const struct dialogboxdata_t *)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_trigger_dialog_box: near

.segment	"CODE"

;
; void trigger_dialog_box(DialogBoxData const * dboxdata) {
;
	jsr     pushax
;
; active_dboxdata = dboxdata;
;
	ldy     #$01
	lda     (sp),y
	sta     _active_dboxdata+1
	dey
	lda     (sp),y
	sta     _active_dboxdata
;
; game_mode = MODE_GAME_SHOWING_TEXT;
;
	lda     #$05
	sta     _game_mode
;
; }
;
	jmp     incsp2

.endproc

; ---------------------------------------------------------------
; void __near__ draw_dialog_text (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_draw_dialog_text: near

.segment	"CODE"

;
; }
;
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ draw_box (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_draw_box: near

.segment	"CODE"

;
; temp0 = high_byte(scroll_y);
;
	lda     _scroll_y+1
	sta     _temp0
;
; nt = (temp0 & 1) << 1; // 0 or 2 for vertical scrolling
;
	and     #$01
	asl     a
	sta     _nt
;
; set_data_pointer(dbox_tiles);
;
	lda     #<(_dbox_tiles)
	ldx     #>(_dbox_tiles)
	jmp     _set_data_pointer

.endproc

